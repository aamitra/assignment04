---
title: "Assignment 04"
author: "Ankushi Mitra"
date: "10/10/2021"
output: html_document
urlcolor: blue
---

```{r setup, pagenumbering="arabic", include=FALSE}
knitr::opts_chunk$set(echo = TRUE, results = "hide")
```

Dataset sourced from [Afrobarometer (Round 7)](https://afrobarometer.org/data/merged-round-7-data-34-countries-2019).

Codebook sourced from [Afrobarometer](https://afrobarometer.org/sites/default/files/r7_merged.codebook_final_14dec20.pdf).

Afrobarometer is a multi-round survey that provides data on public attitudes to democracy, governance, society, and economy across the continent, produced by the non-partisan, pan-African research organization Afrobarometer. Round 7 of Afrobarometer includes data from 34 countries.\



## Visualization 1

What is the relationship between GDP and popular perceptions of the present economic situation in surveyed countries? This visualization merges data from Afrobarometer and World Bank and plots the average assessment of economic conditions against GDP as a measure of national wealth. It appears that there isn't a very strong overall relationship between GDP and perceptions of a country's economic situation on the continent. There are some interesting outliers, including Tunisia, Tanzania, Kenya, Nigeria, South Africa, Ghana, and Morocco—all countries with higher levels of national wealth, yet also reporting more negative assessments of prevailing national economic conditions compared to other countries in Africa. Why does the public perception diverge from trends in economic output and wealth generation in these countries? On the one hand, this may be indicative of some of the limitations of subjective data. On another hand, it may be telling us something important about the structures of income distribution on the continent, which is explored further below.\



```{r}

library(tidyverse)
library(ggplot2)
library(haven)
library(readxl)
library(scales)
library(ggthemes)


AB <- read_sav("/Users/ankushi/Desktop/GOVT-772_Data_Science/assignment04/AB_R7_Merged")
GDP <- read_excel("/Users/ankushi/Desktop/GOVT-772_Data_Science/assignment04/gdp_AB.xlsx")
country_labels <- read_excel("/Users/ankushi/Desktop/GOVT-772_Data_Science/assignment04/labelfile_AB.xlsx")

# descriptive data on Q4A: how would you describe the present economic situation of the country?
AB %>% count(Q4A) #dropping missing (-1), "refused" (8), and "dont know" (9) values 
group_by(AB, Q4A) 
AB <- AB %>%
  filter(Q4A<8, Q4A>-1) 
summarize(AB, mean(Q4A), sd(Q4A), fivenum(Q4A))

#mean value of economic evaluation by country 
df2 <- AB %>% group_by(COUNTRY) %>%
  summarise(mean(Q4A)) %>%
  print(n=34)

#combining separate label file from Afrobarometer and GDP data from World Bank microdata catalog 
df3 <- bind_cols(country_labels$country_lbl, df2$COUNTRY, df2$`mean(Q4A)`, GDP$`GDP (Current US$, 2020)`) 
df3 <- rename(df3, country_lbl = ...1, country = ...2, avg = ...3, gdp = ...4)

theme_set(theme_fivethirtyeight())
econ_gdp <- ggplot(df3, aes(x=gdp, y=avg)) + 
  geom_point(alpha = 0.01) + 
  geom_text(aes(label=country_lbl), size=2, check_overlap = TRUE) +
  labs(
    title = "Evaluation of Country's Present Economic Situation (Very Bad to Very Good)",
    subtitle = "By GDP (2020, US$)",
    caption = "Sources: Afrobarometer R7; World Bank",
    x = "GDP (2020, US$)",
    y = "Opinion on Country's Present Economic Situation (Very Bad to Very Good)"
  ) + 
  theme(
    plot.title = element_text(color = "grey35", size = 10, face = "bold", hjust = 0.5),
    plot.subtitle = element_text(size = 8, hjust = 0.5),
    plot.caption = element_text(face = "italic", size = 6, hjust = 1), 
  ) +
  theme(axis.text.x = element_text(size=7), 
        axis.text.y = element_text(size=7),
        axis.title.x = element_text(size=8),
        axis.title.y = element_text(size=8)) +
  theme(
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    panel.background = element_blank(),
    plot.background = element_blank()) +
  scale_x_log10(labels = label_number(suffix = "B", scale = 1e-9))
econ_gdp

```


## Visualization 2 (Comparison)

Continuing the exploration above, these comparative visualizations use smoothed conditional means to further dig into trends in the GDP data, confirming that there isn't a strong or unidirectional relationship between national wealth and average opinions on economic conditions. GDP as a measure of national wealth is compared here to a measure of national wealth per person, obtained by merging World Bank data on GDP Per Capita with opinion polling on economic conditions in Afrobarometer R7. This graph shows a more positive relationship between wealth per capita and economic opinions, albeit not a very strongly positive one. Most African countries are low- to middle-income, clustered around and under $2,500 GDP per capita, with a relatively wide diversity of economic opinions within that group, and moreover, the wide confidence bands indicate a great deal of variation within the data. There appears to be a fairly even divide between countries where assessments of economic conditions fall below the actual average GDP per capita and those falling above. Tunisia, South Africa, and Gabon remain interesting exceptions—all higher in per capita wealth than much of the continent, yet with gloomy assessments of prevailing economic conditions. This may be linked to the distribution of wealth in these countries: South Africa is the most unequal country in the world as measured by the Gini coefficient [(World Bank, 2014)](https://data.worldbank.org/indicator/SI.POV.GINI?locations=ZA); Tunisia was the birthplace of the "Arab Spring" in 2010 and continues to see high levels of protest against socioeconomic conditions in the country, and Gabon's economy has benefited greatly from oil rents, but its natural resource wealth remains concentrated among upper quintiles of the population [(Yates, 1996)](https://www.degruyter.com/database/IABO/entry/iab19973127/html).\



```{r}

theme_set(theme_fivethirtyeight())
econ_gdp_smoothed <- ggplot(df3, aes(x=gdp, y=avg)) + 
  geom_point(alpha = 0.01) + 
  geom_text(aes(label=country_lbl), size=2, check_overlap = TRUE) +
  geom_smooth(inherit.aes = TRUE) +
  labs(
    title = "Opinions on Country's Present Economic Situation (Very Bad to Very Good)",
    subtitle = "By GDP (2020, US$)",
    caption = "Sources: Afrobarometer R7; World Bank",
    x = "GDP (2020, US$)",
    y = "Opinion on Country's Present Economic Situation (Very Bad to Very Good)"
  ) + 
  theme(
    plot.title = element_text(color = "grey35", size = 9, face = "bold", hjust = 0.5),
    plot.subtitle = element_text(size = 8, hjust = 0.5),
    plot.caption = element_text(face = "italic", size = 6, hjust = 1), 
  ) +
  theme(axis.text.x = element_text(size=7), 
        axis.text.y = element_text(size=7),
        axis.title.x = element_text(size=8),
        axis.title.y = element_text(size=8)) +
  theme(
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    panel.background = element_blank(),
    plot.background = element_blank()) +
  scale_x_log10(labels = label_number(suffix = "B", scale = 1e-9))
econ_gdp_smoothed


GDPPC <- read_excel("/Users/ankushi/Desktop/GOVT-772_Data_Science/assignment04/gdpPC_AB.xlsx")
df3 <- bind_cols(df3, GDPPC)

theme_set(theme_fivethirtyeight())
econ_gdppc <- ggplot(df3, aes(x=`GDP Per Capita`, y=avg)) + 
  geom_point(alpha = 0.01) + 
  geom_text(aes(label=country_lbl), size=2, check_overlap = TRUE) +
  geom_smooth(inherit.aes = TRUE) +
  labs(
    title = "Opinions on Country's Present Economic Situation (Very Bad to Very Good)",
    subtitle = "By GDP Per Capita (2020, US$)",
    caption = "Sources: Afrobarometer R7; World Bank",
    x = "GDP Per Capita (2020, US$)",
    y = "Opinion on Country's Present Economic Situation (Very Bad to Very Good)"
  ) + 
  theme(
    plot.title = element_text(color = "grey35", size = 9, face = "bold", hjust = 0.5),
    plot.subtitle = element_text(size = 8, hjust = 0.5),
    plot.caption = element_text(face = "italic", size = 6, hjust = 1)) +
  theme(axis.text.x = element_text(size=7), 
        axis.text.y = element_text(size=7),
        axis.title.x = element_text(size=8),
        axis.title.y = element_text(size=8)) +
  theme(
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    panel.background = element_blank(),
    plot.background = element_blank()) 
econ_gdppc
  

```

## Visualization 3

What factors might account for the divergence between wealth generation and public perception on the continent, particularly for outlier countries like Tunisia and South Africa? One trend worth exploring further is the spatial divide between urban and rural segments of the sample. Africa is still majority rural [(World Bank, 2020)](https://data.worldbank.org/indicator/SP.RUR.TOTL.ZS?locations=ZG), but is rapidly urbanizing and is a site of high levels of rural-to-urban migration. This visualization plots opinions of prevailing economic situations by urban-rural breakdowns in Afrobarometer R7, whose sample is stratified by locality among other factors. A higher proportion of rural respondents express economic grievances, and the difference between urban and rural populations reporting "fairly bad" conditions is relatively steep, which may suggest that the rural experience of relative poverty and inequality in Africa may be structurally different than the urban experience in important ways, which scholars like Kanbur and Venables [(2005)](https://oxford.universitypressscholarship.com/view/10.1093/0199278636.001.0001/acprof-9780199278633) have highlighted elsewhere.\




```{r}


AB <- read_sav("/Users/ankushi/Desktop/GOVT-772_Data_Science/assignment04/AB_R7_Merged")

# descriptive data on Q4A: how would you describe the present economic situation of the country?
AB %>% count(Q4A) #dropping missing (-1), "refused" (8), and "dont know" (9) values 
group_by(AB, Q4A) 
AB <- AB %>%
  filter(Q4A<8, Q4A>-1) 

AB %>% count(URBRUR) #dropping obvs. coded as "semi urban" and "peri urban" since they are a small proportion of the sample
AB <- AB %>%
  filter(URBRUR<3) 

AB %>% group_by(Q4A, URBRUR) %>% #understanding proportions in the urban-rural split
  summarize(sum(URBRUR))

theme_set(theme_fivethirtyeight()) 
ggplot() +
  geom_bar(data = AB, (aes(x = Q4A, group = URBRUR, fill = factor(URBRUR))), position = "dodge") +
  theme(
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    panel.background = element_blank(), 
    plot.background = element_blank()) +
  labs(
    title = "Opinions on Country's Present Economic Condition",
    subtitle = "By Location",
    caption = "Source: Afrobarometer R7",
    x = "Opinions on Economic Condition",
    y = "Number of Respondents") +
  theme(
    plot.title = element_text(color = "grey35", size = 10, face = "bold", hjust = 0.5),
    plot.subtitle = element_text(size = 8, hjust = 0.5),
    plot.caption = element_text(face = "italic", size = 5, hjust = 1)) +
  theme(axis.text.x = element_text(size=5), 
        axis.text.y = element_text(size=5), 
        axis.title.x = element_text(size=8),
        axis.title.y = element_text(size=8)) +
  scale_fill_discrete(name = "Location", labels = c("Urban", "Rural")) +
  theme(legend.title = element_blank(),
        legend.background = element_blank(),
        legend.key = element_blank(),
        legend.key.size = unit(0.3, "cm"),
        legend.text = element_text(size = 8)) +
  scale_x_continuous(breaks=c(1,2,3,4,5), 
                     labels=expression("Very Bad", "Fairly Bad",
                                       "Neither", "Fairly Good", "Very Good"))

```

## Visualization 4

What is the relationship between perceptions of economic well-being and political aspirations and opinions? Q29A of Afrobarometer asks: is it more important to have a government that can get things done, even if we have no influence over what it does? (I have deliberately chosen this question as one measure of democratic aspiration rather than questions on Afrobarometer that directly ask respondents to rate their support for "democracy" since the terminology of "democracy" carries Western connotations in many states in the global south, which can bias the results). Responses to this question on democratic accountability are compared here to opinions on economic conditions through a jitter plot, which allows for a visualization of how responses to these two questions are cross-distributed. Support for democratic accountability throughout the surveyed African countries is robust. Moreover, interestingly, "very bad" or "fairly bad" ratings of economic conditions also correspond to the densest support for principles of accountability, which runs counter to some claims that populations will be more willing to support authoritarian politics when economic grievances are high and/or in exchange for economic patronage [(Svolik, 2012)](https://politicalscience.yale.edu/publications/politics-authoritarian-rule). 

```{r}

AB <- read_sav("/Users/ankushi/Desktop/GOVT-772_Data_Science/assignment04/AB_R7_Merged")

AB %>% count(Q4A) #dropping missing (-1), "refused" (8), and "dont know" (9) values 
AB <- AB %>%
  filter(Q4A<8, Q4A>-1) 

AB %>% count(Q29) #dropping missing (-1), "refused" (8), "dont know" (9), and "neither" (5) values 
AB <- AB %>%
  filter(Q29<5, Q29 > -1) 

theme_set(theme_fivethirtyeight()) 
AB %>% ggplot() +
  geom_jitter(aes(x=Q4A, y=Q29), size=0.3, color="#91b8bd") +
  theme(
  panel.grid.major = element_blank(),
  panel.grid.minor = element_blank(),
  panel.background = element_blank(), 
  plot.background = element_blank()) +
  labs(
    title = "Is It More Important To Have A Government That Can Get Things Done, 
    Even If We Have No Influence Over What It Does?",
    subtitle = "By Assessment of Country's Present Economic Condition",
    caption = "Source: Afrobarometer R7",
    x = "Assessment of Economic Conditions (Very Bad to Very Good)",
    y = "Support for Democratic Accountability (Less Supportive to More Supportive)") +
  theme(
    plot.title = element_text(color = "grey35", size = 8.5, face = "bold", hjust = 0.5),
    plot.subtitle = element_text(size = 7.5, hjust = 0.5),
    plot.caption = element_text(face = "italic", size = 5, hjust = 1)) +
  theme(axis.text.x = element_text(size=7), 
        axis.text.y = element_text(size=7), 
        axis.title.x = element_text(size=7),
        axis.title.y = element_text(size=7)) 

```


